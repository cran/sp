
R : Copyright 2005, The R Foundation for Statistical Computing
Version 2.1.0 beta (2005-04-10), ISBN 3-900051-07-0

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for a HTML browser interface to help.
Type 'q()' to quit R.

> library(sp)
> data(meuse.grid)
> x = meuse.grid
> coordinates(x) = c("x", "y")
> gridded(x) = TRUE
> gridded(x)
[1] TRUE
> image(x["dist"])
> 
> fullgrid(x) = TRUE
> fullgrid(x)
[1] TRUE
> summary(x)
Object of class SpatialGridDataFrame
Coordinates:
     min    max
x 178460 181540
y 329620 333740
Is projected: NA 
proj4string : [NA]
Number of points: 2
Grid attributes:
  cellcentre.offset cellsize cells.dim
x            178460       40        78
y            329620       40       104
Data attributes:
     part.a              part.b               dist                soil         
 Min.   :   0.0000   Min.   :   0.0000   Min.   :   0.0000   Min.   :   1.000  
 1st Qu.:   0.0000   1st Qu.:   0.0000   1st Qu.:   0.1193   1st Qu.:   1.000  
 Median :   0.0000   Median :   1.0000   Median :   0.2715   Median :   1.000  
 Mean   :   0.3986   Mean   :   0.6014   Mean   :   0.2971   Mean   :   1.578  
 3rd Qu.:   1.0000   3rd Qu.:   1.0000   3rd Qu.:   0.4402   3rd Qu.:   2.000  
 Max.   :   1.0000   Max.   :   1.0000   Max.   :   0.9926   Max.   :   3.000  
 NA's   :5009.0000   NA's   :5009.0000   NA's   :5009.0000   NA's   :5009.000  
     ffreq         
 Min.   :   1.000  
 1st Qu.:   1.000  
 Median :   2.000  
 Mean   :   2.068  
 3rd Qu.:   3.000  
 Max.   :   3.000  
 NA's   :5009.000  
> gridparameters(x)
  cellcentre.offset cellsize cells.dim
x            178460       40        78
y            329620       40       104
> class(as(x, "matrix"))
[1] "matrix"
Warning message:
as.matrix.SpatialPixelsDataFrame uses first column;
 pass subset or [] for other columns in: as.matrix.SpatialGridDataFrame(from) 
> 
> fullgrid(x) = FALSE
> fullgrid(x)
[1] FALSE
> summary(x)
Object of class SpatialPixelsDataFrame
Coordinates:
     min    max
x 178460 181540
y 329620 333740
Is projected: NA 
proj4string : [NA]
Number of points: 3103
Data attributes:
     part.a           part.b            dist             soil      
 Min.   :0.0000   Min.   :0.0000   Min.   :0.0000   Min.   :1.000  
 1st Qu.:0.0000   1st Qu.:0.0000   1st Qu.:0.1193   1st Qu.:1.000  
 Median :0.0000   Median :1.0000   Median :0.2715   Median :1.000  
 Mean   :0.3986   Mean   :0.6014   Mean   :0.2971   Mean   :1.578  
 3rd Qu.:1.0000   3rd Qu.:1.0000   3rd Qu.:0.4402   3rd Qu.:2.000  
 Max.   :1.0000   Max.   :1.0000   Max.   :0.9926   Max.   :3.000  
     ffreq      
 Min.   :1.000  
 1st Qu.:1.000  
 Median :2.000  
 Mean   :2.068  
 3rd Qu.:3.000  
 Max.   :3.000  
> class(as(x, "matrix"))
[1] "matrix"
Warning message:
as.matrix.SpatialPixelsDataFrame uses first column;
 pass subset or [] for other columns in: as.matrix.SpatialGridDataFrame(from) 
> gridparameters(x)
  cellcentre.offset cellsize cells.dim
x            178460       40        78
y            329620       40       104
> 
> df = data.frame(z = c(1:6,NA,8,9), 
+ 	xc = c(1,1,1,2,2,2,3,3,3), 
+ 	yc = c(rep(c(0, 1.5, 3),3)))
> 
> coordinates(df) = ~xc+yc
> gridded(df) = TRUE
> gridparameters(df)
   cellcentre.offset cellsize cells.dim
xc                 1      1.0         3
yc                 0      1.5         3
> as(df, "matrix")
     [,1] [,2] [,3]
[1,]    3    2    1
[2,]    6    5    4
[3,]    9    8   NA
> 
> # get grid topology:
> grd = points2grid(as(df, "SpatialPoints"), 1e-31) 
> grd
                  xc  yc
cellcentre.offset  1 0.0
cellsize           1 1.5
cells.dim          3 3.0
> getGridIndex(coordinates(df), grd)
[1] 7 4 1 8 5 2 9 6 3
> 
> g = SpatialGrid(grid = grd)
> fullgrid(g)
[1] TRUE
> fullgrid(g) = TRUE
> class(g)
[1] "SpatialGrid"
attr(,"package")
[1] "sp"
> # the next one has to fail:
> fullgrid(g) <- FALSE
> class(g)
[1] "SpatialPixels"
attr(,"package")
[1] "sp"
> 
> print(summary(df))
Object of class SpatialPixelsDataFrame
Coordinates:
   min max
xc   1   3
yc   0   3
Is projected: NA 
proj4string : [NA]
Number of points: 9
Data attributes:
       z       
 Min.   :1.00  
 1st Qu.:2.75  
 Median :4.50  
 Mean   :4.75  
 3rd Qu.:6.50  
 Max.   :9.00  
 NA's   :1.00  
> image(df["z"])
> as.image.SpatialGridDataFrame(df)
$x
[1] 1 2 3

$y
[1] 0.0 1.5 3.0

$z
     [,1] [,2] [,3]
[1,]    1    2    3
[2,]    4    5    6
[3,]   NA    8    9

> as.image.SpatialGridDataFrame(df["z"])
$x
[1] 1 2 3

$y
[1] 0.0 1.5 3.0

$z
     [,1] [,2] [,3]
[1,]    1    2    3
[2,]    4    5    6
[3,]   NA    8    9

> coordinatevalues(getGridTopology(df))
$xc
[1] 1 2 3

$yc
[1] 3.0 1.5 0.0

> 
> as.data.frame(df)
   z xc  yc
1  1  1 0.0
2  2  1 1.5
3  3  1 3.0
4  4  2 0.0
5  5  2 1.5
6  6  2 3.0
7 NA  3 0.0
8  8  3 1.5
9  9  3 3.0
> 
> fullgrid(df) = TRUE
> as.data.frame(df)
  z xc  yc
1 3  1 3.0
2 6  2 3.0
3 9  3 3.0
4 2  1 1.5
5 5  2 1.5
6 8  3 1.5
7 1  1 0.0
8 4  2 0.0
> 
> fullgrid(df) = FALSE  
> as.data.frame(df)
  z xc  yc
1 3  1 3.0
2 6  2 3.0
3 9  3 3.0
4 2  1 1.5
5 5  2 1.5
6 8  3 1.5
7 1  1 0.0
8 4  2 0.0
> 
> fullgrid(df) = TRUE
> fullgrid(df) = FALSE
> as.data.frame(df)
  z xc  yc
1 3  1 3.0
2 6  2 3.0
3 9  3 3.0
4 2  1 1.5
5 5  2 1.5
6 8  3 1.5
7 1  1 0.0
8 4  2 0.0
> 
